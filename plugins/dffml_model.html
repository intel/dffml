

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Models &mdash; DFFML 0.3.7 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Operations" href="dffml_operation.html" />
    <link rel="prev" title="Sources" href="dffml_source.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> DFFML
          

          
          </a>

          
            
            
              <div class="version">
                0.3.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/index.html">Concepts</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/model.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/index.html">Use Cases</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Plugins</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="dffml_source.html">Sources</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dffml">dffml</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#slr">slr</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dffml-model-tensorflow">dffml_model_tensorflow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tfdnnc">tfdnnc</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tfdnnr">tfdnnr</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dffml-model-tensorflow-hub">dffml_model_tensorflow_hub</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#text-classifier">text_classifier</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dffml-model-transformers">dffml_model_transformers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ner-tagger">ner_tagger</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dffml-model-scratch">dffml_model_scratch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#scratchlgrsag">scratchlgrsag</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dffml-model-scikit">dffml_model_scikit</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dffml_operation.html">Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="dffml_service_cli.html">Services</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="service/http/index.html">HTTP API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/intel/dffml">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact Us</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DFFML</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Plugins</a> &raquo;</li>
        
      <li>Models</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/intel/dffml/blob/master/docs/plugins/dffml_model.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="models">
<span id="plugin-models"></span><h1>Models<a class="headerlink" href="#models" title="Permalink to this headline">¶</a></h1>
<p>Models are implementations of <a class="reference internal" href="../api/model/base.html#dffml.model.model.Model" title="dffml.model.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">dffml.model.model.Model</span></code></a>, they
abstract the usage of machine learning models.</p>
<p>If you want to get started creating your own model, check out the
<a class="reference internal" href="../tutorials/model.html#model-tutorial"><span class="std std-ref">New Model Tutorial</span></a>.</p>
<div class="section" id="dffml">
<span id="plugin-model-dffml"></span><h2>dffml<a class="headerlink" href="#dffml" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pip install dffml</span>
</pre></div>
</div>
<div class="section" id="slr">
<span id="plugin-model-dffml-slr"></span><h3>slr<a class="headerlink" href="#slr" title="Permalink to this headline">¶</a></h3>
<p><em>Official</em></p>
<p>Logistic Regression training one variable to predict another.</p>
<p>The dataset used for training</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">&gt;</span> <span class="n">dataset</span><span class="o">.</span><span class="n">csv</span> <span class="o">&lt;&lt;</span> <span class="n">EOF</span>
<span class="n">f1</span><span class="p">,</span><span class="n">ans</span>
<span class="mf">0.1</span><span class="p">,</span><span class="mi">0</span>
<span class="mf">0.7</span><span class="p">,</span><span class="mi">1</span>
<span class="mf">0.6</span><span class="p">,</span><span class="mi">1</span>
<span class="mf">0.2</span><span class="p">,</span><span class="mi">0</span>
<span class="mf">0.8</span><span class="p">,</span><span class="mi">1</span>
<span class="n">EOF</span>
</pre></div>
</div>
<p>Train the model</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dffml</span> <span class="n">train</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">slr</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">features</span> <span class="n">f1</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">ans</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">f</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="n">dataset</span><span class="o">.</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">log</span> <span class="n">debug</span>
</pre></div>
</div>
<p>Assess the accuracy</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dffml</span> <span class="n">accuracy</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">slr</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">features</span> <span class="n">f1</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">ans</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">f</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="n">dataset</span><span class="o">.</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">log</span> <span class="n">debug</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">1.0</span>
</pre></div>
</div>
<p>Make a prediction</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="o">-</span><span class="n">e</span> <span class="s1">&#39;f1,ans</span><span class="se">\n</span><span class="s1">0.8,0</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">|</span> \
  <span class="n">dffml</span> <span class="n">predict</span> <span class="nb">all</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">slr</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">features</span> <span class="n">f1</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">ans</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">f</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">stdin</span> \
  <span class="o">-</span><span class="n">log</span> <span class="n">debug</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[</span>
<span class="go">    {</span>
<span class="go">        &quot;extra&quot;: {},</span>
<span class="go">        &quot;features&quot;: {</span>
<span class="go">            &quot;ans&quot;: 0,</span>
<span class="go">            &quot;f1&quot;: 0.8</span>
<span class="go">        },</span>
<span class="go">        &quot;last_updated&quot;: &quot;2020-03-19T13:41:08Z&quot;,</span>
<span class="go">        &quot;prediction&quot;: {</span>
<span class="go">            &quot;ans&quot;: {</span>
<span class="go">                &quot;confidence&quot;: 1.0,</span>
<span class="go">                &quot;value&quot;: 1</span>
<span class="go">            }</span>
<span class="go">        },</span>
<span class="go">        &quot;key&quot;: &quot;0&quot;</span>
<span class="go">    }</span>
<span class="go">]</span>
</pre></div>
</div>
<p>Example usage of Logistic Regression using Python</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dffml</span> <span class="kn">import</span> <span class="n">Features</span><span class="p">,</span> <span class="n">DefFeature</span>
<span class="kn">from</span> <span class="nn">dffml.noasync</span> <span class="kn">import</span> <span class="n">train</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">predict</span>
<span class="kn">from</span> <span class="nn">dffml.model.slr</span> <span class="kn">import</span> <span class="n">SLRModel</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SLRModel</span><span class="p">(</span>
    <span class="n">features</span><span class="o">=</span><span class="n">Features</span><span class="p">(</span><span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;f1&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
    <span class="n">predict</span><span class="o">=</span><span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;ans&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Train the model</span>
<span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;dataset.csv&quot;</span><span class="p">)</span>

<span class="c1"># Assess accuracy (alternate way of specifying data source)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy:&quot;</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;dataset.csv&quot;</span><span class="p">))</span>

<span class="c1"># Make prediction</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;f1&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s2">&quot;ans&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}):</span>
    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;ans&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">[</span><span class="s2">&quot;ans&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Args</strong></p>
<ul class="simple">
<li><p>predict: Feature</p>
<ul>
<li><p>Label or the value to be predicted</p></li>
</ul>
</li>
<li><p>features: List of features</p>
<ul>
<li><p>Features to train on. For SLR only 1 allowed</p></li>
</ul>
</li>
<li><p>directory: Path</p>
<ul>
<li><p>default: ~/.cache/dffml/slr</p></li>
<li><p>Directory where state should be saved</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="dffml-model-tensorflow">
<span id="plugin-model-dffml-model-tensorflow"></span><h2>dffml_model_tensorflow<a class="headerlink" href="#dffml-model-tensorflow" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pip install dffml-model-tensorflow</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It’s important to keep the hidden layer config and feature config the same
across invocations of train, predict, and accuracy methods.</p>
<p>Models are saved under the <code class="docutils literal notranslate"><span class="pre">directory</span></code> parameter in subdirectories named
after the hash of their feature names and hidden layer config. Which means
if any of those parameters change between invocations, it’s being told to
look for a different saved model.</p>
</div>
<div class="section" id="tfdnnc">
<span id="plugin-model-dffml-model-tensorflow-tfdnnc"></span><h3>tfdnnc<a class="headerlink" href="#tfdnnc" title="Permalink to this headline">¶</a></h3>
<p><em>Official</em></p>
<p>Implemented using Tensorflow’s DNNClassifier.</p>
<p>First we create the training and testing datasets</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">tensorflow</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">iris_training</span><span class="o">.</span><span class="n">csv</span>
<span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s1">&#39;s/.*setosa,versicolor,virginica/SepalLength,SepalWidth,PetalLength,PetalWidth,classification/g&#39;</span> <span class="o">*.</span><span class="n">csv</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">tensorflow</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">iris_test</span><span class="o">.</span><span class="n">csv</span>
<span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s1">&#39;s/.*setosa,versicolor,virginica/SepalLength,SepalWidth,PetalLength,PetalWidth,classification/g&#39;</span> <span class="o">*.</span><span class="n">csv</span>
</pre></div>
</div>
<p>Train the model</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dffml</span> <span class="n">train</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">tfdnnc</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">epochs</span> <span class="mi">3000</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">steps</span> <span class="mi">20000</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">classification</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">classifications</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">clstype</span> <span class="nb">int</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">iris</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="n">iris_training</span><span class="o">.</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">features</span> \
    <span class="n">SepalLength</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
    <span class="n">SepalWidth</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
    <span class="n">PetalLength</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
    <span class="n">PetalWidth</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">log</span> <span class="n">debug</span>
</pre></div>
</div>
<p>Assess the accuracy</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dffml</span> <span class="n">accuracy</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">tfdnnc</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">classification</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">classifications</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">clstype</span> <span class="nb">int</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">iris</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="n">iris_test</span><span class="o">.</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">features</span> \
    <span class="n">SepalLength</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
    <span class="n">SepalWidth</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
    <span class="n">PetalLength</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
    <span class="n">PetalWidth</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">log</span> <span class="n">critical</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.99996233782</span>
</pre></div>
</div>
<p>Make a prediction</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="o">-</span><span class="n">e</span> <span class="s1">&#39;SepalLength,SepalWidth,PetalLength,PetalWidth</span><span class="se">\n</span><span class="s1">5.9,3.0,4.2,1.5</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">|</span> \
<span class="n">dffml</span> <span class="n">predict</span> <span class="nb">all</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">tfdnnc</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">classification</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">classifications</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">clstype</span> <span class="nb">int</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">iris</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">features</span> \
    <span class="n">SepalLength</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
    <span class="n">SepalWidth</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
    <span class="n">PetalLength</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
    <span class="n">PetalWidth</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">stdin</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
    <span class="p">{</span>
        <span class="nt">&quot;extra&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="nt">&quot;features&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;PetalLength&quot;</span><span class="p">:</span> <span class="mf">4.2</span><span class="p">,</span>
            <span class="nt">&quot;PetalWidth&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
            <span class="nt">&quot;SepalLength&quot;</span><span class="p">:</span> <span class="mf">5.9</span><span class="p">,</span>
            <span class="nt">&quot;SepalWidth&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
            <span class="nt">&quot;classification&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">},</span>
        <span class="nt">&quot;last_updated&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-07-31T02:00:12Z&quot;</span><span class="p">,</span>
        <span class="nt">&quot;prediction&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;classification&quot;</span><span class="p">:</span>
                <span class="p">{</span>
                    <span class="nt">&quot;confidence&quot;</span><span class="p">:</span> <span class="mf">0.9999997615814209</span><span class="p">,</span>
                    <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="mi">1</span>
                <span class="p">}</span>
        <span class="p">},</span>
        <span class="nt">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>
    <span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Example usage of Tensorflow DNNClassifier model using python API</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dffml</span> <span class="kn">import</span> <span class="n">CSVSource</span><span class="p">,</span> <span class="n">Features</span><span class="p">,</span> <span class="n">DefFeature</span>
<span class="kn">from</span> <span class="nn">dffml.noasync</span> <span class="kn">import</span> <span class="n">train</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">predict</span>
<span class="kn">from</span> <span class="nn">dffml_model_tensorflow.dnnc</span> <span class="kn">import</span> <span class="n">DNNClassifierModel</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DNNClassifierModel</span><span class="p">(</span>
    <span class="n">features</span><span class="o">=</span><span class="n">Features</span><span class="p">(</span>
        <span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;SepalLength&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;SepalWidth&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;PetalLength&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;PetalWidth&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">),</span>
    <span class="n">predict</span><span class="o">=</span><span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;classification&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span>
    <span class="n">steps</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span>
    <span class="n">classifications</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="n">clstype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Train the model</span>
<span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;iris_training.csv&quot;</span><span class="p">)</span>

<span class="c1"># Assess accuracy (alternate way of specifying data source)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy:&quot;</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">CSVSource</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;iris_test.csv&quot;</span><span class="p">)))</span>

<span class="c1"># Make prediction</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">predict</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;PetalLength&quot;</span><span class="p">:</span> <span class="mf">4.2</span><span class="p">,</span>
        <span class="s2">&quot;PetalWidth&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
        <span class="s2">&quot;SepalLength&quot;</span><span class="p">:</span> <span class="mf">5.9</span><span class="p">,</span>
        <span class="s2">&quot;SepalWidth&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;PetalLength&quot;</span><span class="p">:</span> <span class="mf">5.4</span><span class="p">,</span>
        <span class="s2">&quot;PetalWidth&quot;</span><span class="p">:</span> <span class="mf">2.1</span><span class="p">,</span>
        <span class="s2">&quot;SepalLength&quot;</span><span class="p">:</span> <span class="mf">6.9</span><span class="p">,</span>
        <span class="s2">&quot;SepalWidth&quot;</span><span class="p">:</span> <span class="mf">3.1</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">):</span>
    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;classification&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">[</span><span class="s2">&quot;classification&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Args</strong></p>
<ul class="simple">
<li><p>predict: Feature</p>
<ul>
<li><p>Feature name holding target values</p></li>
</ul>
</li>
<li><p>features: List of features</p>
<ul>
<li><p>Features to train on</p></li>
</ul>
</li>
<li><p>steps: Integer</p>
<ul>
<li><p>default: 3000</p></li>
<li><p>Number of steps to train the model</p></li>
</ul>
</li>
<li><p>epochs: Integer</p>
<ul>
<li><p>default: 30</p></li>
<li><p>Number of iterations to pass over all records in a source</p></li>
</ul>
</li>
<li><p>directory: Path</p>
<ul>
<li><p>default: ~/.cache/dffml/tensorflow</p></li>
<li><p>Directory where state should be saved</p></li>
</ul>
</li>
<li><p>hidden: List of integers</p>
<ul>
<li><p>default: [12, 40, 15]</p></li>
<li><p>List length is the number of hidden layers in the network. Each entry in the list is the number of nodes in that hidden layer</p></li>
</ul>
</li>
<li><p>classifications: List of strings</p>
<ul>
<li><p>default: None</p></li>
<li><p>Options for value of classification</p></li>
</ul>
</li>
<li><p>clstype: Type</p>
<ul>
<li><p>default: &lt;class ‘str’&gt;</p></li>
<li><p>Data type of classifications values</p></li>
</ul>
</li>
<li><p>batchsize: Integer</p>
<ul>
<li><p>default: 20</p></li>
<li><p>Number records to pass through in an epoch</p></li>
</ul>
</li>
<li><p>shuffle: Boolean</p>
<ul>
<li><p>default: True</p></li>
<li><p>Randomise order of records in a batch</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="tfdnnr">
<span id="plugin-model-dffml-model-tensorflow-tfdnnr"></span><h3>tfdnnr<a class="headerlink" href="#tfdnnr" title="Permalink to this headline">¶</a></h3>
<p><em>Official</em></p>
<p>Implemented using Tensorflow’s DNNEstimator.</p>
<p>Usage:</p>
<ul class="simple">
<li><p>predict: Name of the feature we are trying to predict or using for training.</p></li>
</ul>
<p>Generating train and test data</p>
<ul class="simple">
<li><p>This creates files <cite>train.csv</cite> and <cite>test.csv</cite>,
make sure to take a BACKUP of files with same name in the directory
from where this command is run as it overwrites any existing files.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">&gt;</span> <span class="n">train</span><span class="o">.</span><span class="n">csv</span> <span class="o">&lt;&lt;</span> <span class="n">EOF</span>
<span class="n">Feature1</span><span class="p">,</span><span class="n">Feature2</span><span class="p">,</span><span class="n">TARGET</span>
<span class="mf">0.93</span><span class="p">,</span><span class="mf">0.68</span><span class="p">,</span><span class="mf">3.89</span>
<span class="mf">0.24</span><span class="p">,</span><span class="mf">0.42</span><span class="p">,</span><span class="mf">1.75</span>
<span class="mf">0.36</span><span class="p">,</span><span class="mf">0.68</span><span class="p">,</span><span class="mf">2.75</span>
<span class="mf">0.53</span><span class="p">,</span><span class="mf">0.31</span><span class="p">,</span><span class="mf">2.00</span>
<span class="mf">0.29</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">1.32</span>
<span class="mf">0.29</span><span class="p">,</span><span class="mf">0.52</span><span class="p">,</span><span class="mf">2.14</span>
<span class="n">EOF</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">&gt;</span> <span class="n">test</span><span class="o">.</span><span class="n">csv</span> <span class="o">&lt;&lt;</span> <span class="n">EOF</span>
<span class="n">Feature1</span><span class="p">,</span><span class="n">Feature2</span><span class="p">,</span><span class="n">TARGET</span>
<span class="mf">0.57</span><span class="p">,</span><span class="mf">0.84</span><span class="p">,</span><span class="mf">3.65</span>
<span class="mf">0.95</span><span class="p">,</span><span class="mf">0.19</span><span class="p">,</span><span class="mf">2.46</span>
<span class="mf">0.23</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.93</span>
<span class="n">EOF</span>
</pre></div>
</div>
<p>Train the model</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dffml</span> <span class="n">train</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">tfdnnr</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">epochs</span> <span class="mi">300</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">steps</span> <span class="mi">2000</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">TARGET</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">hidden</span> <span class="mi">8</span> <span class="mi">16</span> <span class="mi">8</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">s</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="n">train</span><span class="o">.</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">features</span> \
    <span class="n">Feature1</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
    <span class="n">Feature2</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">log</span> <span class="n">debug</span>
</pre></div>
</div>
<p>Assess the accuracy</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dffml</span> <span class="n">accuracy</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">tfdnnr</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">TARGET</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">hidden</span> <span class="mi">8</span> <span class="mi">16</span> <span class="mi">8</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">s</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="n">test</span><span class="o">.</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">features</span> \
    <span class="n">Feature1</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
    <span class="n">Feature2</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">log</span> <span class="n">critical</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.9468210011</span>
</pre></div>
</div>
<p>Make a prediction</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="o">-</span><span class="n">e</span> <span class="s1">&#39;Feature1,Feature2,TARGET</span><span class="se">\n</span><span class="s1">0.21,0.18,0.84</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">|</span> \
  <span class="n">dffml</span> <span class="n">predict</span> <span class="nb">all</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">tfdnnr</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">TARGET</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">hidden</span> <span class="mi">8</span> <span class="mi">16</span> <span class="mi">8</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">s</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">stdin</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">features</span> \
    <span class="n">Feature1</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
    <span class="n">Feature2</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">log</span> <span class="n">critical</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span>[
    {
        &quot;extra&quot;: {},
        &quot;features&quot;: {
            &quot;Feature1&quot;: 0.21,
            &quot;Feature2&quot;: 0.18,
            &quot;TARGET&quot;: 0.84
        },
        &quot;last_updated&quot;: &quot;2019-10-24T15:26:41Z&quot;,
        &quot;prediction&quot;: {
            &quot;TARGET&quot; : {
                &quot;confidence&quot;: NaN,
                &quot;value&quot;: 1.1983429193496704
            }
        },
        &quot;key&quot;: 0
    }
]
</pre></div>
</div>
<p>Example usage of Tensorflow DNNEstimator model using python API</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dffml</span> <span class="kn">import</span> <span class="n">CSVSource</span><span class="p">,</span> <span class="n">Features</span><span class="p">,</span> <span class="n">DefFeature</span>
<span class="kn">from</span> <span class="nn">dffml.noasync</span> <span class="kn">import</span> <span class="n">train</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">predict</span>
<span class="kn">from</span> <span class="nn">dffml_model_tensorflow.dnnr</span> <span class="kn">import</span> <span class="n">DNNRegressionModel</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DNNRegressionModel</span><span class="p">(</span>
    <span class="n">features</span><span class="o">=</span><span class="n">Features</span><span class="p">(</span>
        <span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;Feature1&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;Feature2&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">predict</span><span class="o">=</span><span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;TARGET&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">steps</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
    <span class="n">hidden</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># Train the model</span>
<span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;train.csv&quot;</span><span class="p">)</span>

<span class="c1"># Assess accuracy (alternate way of specifying data source)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy:&quot;</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">CSVSource</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;test.csv&quot;</span><span class="p">)))</span>

<span class="c1"># Make prediction</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">predict</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;Feature1&quot;</span><span class="p">:</span> <span class="mf">0.21</span><span class="p">,</span> <span class="s2">&quot;Feature2&quot;</span><span class="p">:</span> <span class="mf">0.18</span><span class="p">,</span> <span class="s2">&quot;TARGET&quot;</span><span class="p">:</span> <span class="mf">0.84</span><span class="p">}</span>
<span class="p">):</span>
    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;TARGET&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">[</span><span class="s2">&quot;TARGET&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">NaN</span></code> in <code class="docutils literal notranslate"><span class="pre">confidence</span></code> is the expected behaviour. (See TODO in
predict).</p>
<p><strong>Args</strong></p>
<ul class="simple">
<li><p>predict: Feature</p>
<ul>
<li><p>Feature name holding target values</p></li>
</ul>
</li>
<li><p>features: List of features</p>
<ul>
<li><p>Features to train on</p></li>
</ul>
</li>
<li><p>steps: Integer</p>
<ul>
<li><p>default: 3000</p></li>
<li><p>Number of steps to train the model</p></li>
</ul>
</li>
<li><p>epochs: Integer</p>
<ul>
<li><p>default: 30</p></li>
<li><p>Number of iterations to pass over all records in a source</p></li>
</ul>
</li>
<li><p>directory: Path</p>
<ul>
<li><p>default: ~/.cache/dffml/tensorflow</p></li>
<li><p>Directory where state should be saved</p></li>
</ul>
</li>
<li><p>hidden: List of integers</p>
<ul>
<li><p>default: [12, 40, 15]</p></li>
<li><p>List length is the number of hidden layers in the network. Each entry in the list is the number of nodes in that hidden layer</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="dffml-model-tensorflow-hub">
<span id="plugin-model-dffml-model-tensorflow-hub"></span><h2>dffml_model_tensorflow_hub<a class="headerlink" href="#dffml-model-tensorflow-hub" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pip install dffml-model-tensorflow-hub</span>
</pre></div>
</div>
<div class="section" id="text-classifier">
<span id="plugin-model-dffml-model-tensorflow-hub-text-classifier"></span><h3>text_classifier<a class="headerlink" href="#text-classifier" title="Permalink to this headline">¶</a></h3>
<p><em>Official</em></p>
<p>Implemented using Tensorflow hub pretrained models.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cat &gt; train.csv &lt;&lt; EOF
<span class="go">sentence,sentiment</span>
<span class="go">Life is good,1</span>
<span class="go">This book is amazing,1</span>
<span class="go">It&#39;s a terrible movie,0</span>
<span class="go">Global warming is bad,0</span>
<span class="go">EOF</span>
<span class="gp">$ </span>cat &gt; test.csv &lt;&lt; EOF
<span class="go">sentence,sentiment</span>
<span class="go">I am not feeling good,0</span>
<span class="go">Our trip was full of adventures,1</span>
<span class="go">EOF</span>
<span class="gp">$ </span>dffml train <span class="se">\</span>
<span class="go">    -model text_classifier \</span>
<span class="go">    -model-epochs 30 \</span>
<span class="go">    -model-predict sentiment:int:1 \</span>
<span class="go">    -model-classifications 0 1  \</span>
<span class="go">    -model-clstype int \</span>
<span class="go">    -sources f=csv \</span>
<span class="go">    -source-filename train.csv \</span>
<span class="go">    -model-features \</span>
<span class="go">      sentence:str:1 \</span>
<span class="go">    -model-model_path &quot;https://tfhub.dev/google/tf2-preview/gnews-swivel-20dim-with-oov/1&quot; \</span>
<span class="go">    -model-add_layers \</span>
<span class="go">    -model-layers &quot;Dense(units=512, activation=&#39;relu&#39;)&quot; &quot;Dense(units=2, activation=&#39;softmax&#39;)&quot; \</span>
<span class="go">    -log debug</span>
<span class="gp">$ </span>dffml accuracy <span class="se">\</span>
<span class="go">    -model text_classifier \</span>
<span class="go">    -model-predict sentiment:int:1 \</span>
<span class="go">    -model-classifications 0 1 \</span>
<span class="go">    -model-model_path &quot;https://tfhub.dev/google/tf2-preview/gnews-swivel-20dim-with-oov/1&quot; \</span>
<span class="go">    -model-clstype int \</span>
<span class="go">    -sources f=csv \</span>
<span class="go">    -source-filename test.csv \</span>
<span class="go">    -model-features \</span>
<span class="go">      sentence:str:1 \</span>
<span class="go">    -log critical</span>
<span class="go">    1.0</span>
<span class="gp">$ </span>dffml predict all <span class="se">\</span>
<span class="go">    -model text_classifier \</span>
<span class="go">    -model-predict sentiment:int:1 \</span>
<span class="go">    -model-classifications 0 1 \</span>
<span class="go">    -model-model_path &quot;https://tfhub.dev/google/tf2-preview/gnews-swivel-20dim-with-oov/1&quot; \</span>
<span class="go">    -model-clstype int \</span>
<span class="go">    -sources f=csv \</span>
<span class="go">    -source-filename test.csv \</span>
<span class="go">    -model-features \</span>
<span class="go">      sentence:str:1 \</span>
<span class="go">    -log debug</span>
<span class="go">[</span>
<span class="go">    {</span>
<span class="go">        &quot;extra&quot;: {},</span>
<span class="go">        &quot;features&quot;: {</span>
<span class="go">            &quot;sentence&quot;: &quot;I am not feeling good&quot;,</span>
<span class="go">            &quot;sentiment&quot;: 0</span>
<span class="go">        },</span>
<span class="go">        &quot;key&quot;: &quot;0&quot;,</span>
<span class="go">        &quot;last_updated&quot;: &quot;2020-02-15T02:54:02Z&quot;,</span>
<span class="go">        &quot;prediction&quot;: {</span>
<span class="go">            &quot;sentiment&quot;: {</span>
<span class="go">                &quot;confidence&quot;: 0.7630850076675415,</span>
<span class="go">                &quot;value&quot;: 0</span>
<span class="go">            }</span>
<span class="go">        }</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">        &quot;extra&quot;: {},</span>
<span class="go">        &quot;features&quot;: {</span>
<span class="go">            &quot;sentence&quot;: &quot;Our trip was full of adventures&quot;,</span>
<span class="go">            &quot;sentiment&quot;: 1</span>
<span class="go">        },</span>
<span class="go">        &quot;key&quot;: &quot;1&quot;,</span>
<span class="go">        &quot;last_updated&quot;: &quot;2020-02-15T02:54:02Z&quot;,</span>
<span class="go">        &quot;prediction&quot;: {</span>
<span class="go">            &quot;sentiment&quot;: {</span>
<span class="go">                &quot;confidence&quot;: 0.6673157811164856,</span>
<span class="go">                &quot;value&quot;: 1</span>
<span class="go">            }</span>
<span class="go">        }</span>
<span class="go">    }</span>
<span class="go">]</span>
</pre></div>
</div>
<p><strong>Args</strong></p>
<ul class="simple">
<li><p>predict: Feature</p>
<ul>
<li><p>Feature name holding classification value</p></li>
</ul>
</li>
<li><p>classifications: List of strings</p>
<ul>
<li><p>Options for value of classification</p></li>
</ul>
</li>
<li><p>features: List of features</p>
<ul>
<li><p>Features to train on</p></li>
</ul>
</li>
<li><p>trainable: String</p>
<ul>
<li><p>default: True</p></li>
<li><p>Tweak pretrained model by training again</p></li>
</ul>
</li>
<li><p>batch_size: Integer</p>
<ul>
<li><p>default: 120</p></li>
<li><p>Batch size</p></li>
</ul>
</li>
<li><p>max_seq_length: Integer</p>
<ul>
<li><p>default: 256</p></li>
<li><p>Length of sentence, used in preprocessing of input for bert embedding</p></li>
</ul>
</li>
<li><p>add_layers: Boolean</p>
<ul>
<li><p>default: False</p></li>
<li><p>Add layers on the top of pretrianed model/layer</p></li>
</ul>
</li>
<li><p>embedType: String</p>
<ul>
<li><p>default: None</p></li>
<li><p>Type of pretrained embedding model, required to be set to <cite>bert</cite> to use bert pretrained embedding</p></li>
</ul>
</li>
<li><p>layers: List of strings</p>
<ul>
<li><p>default: None</p></li>
<li><p>Extra layers to be added on top of pretrained model</p></li>
</ul>
</li>
<li><p>model_path: String</p>
<ul>
<li><p>default: <a class="reference external" href="https://tfhub.dev/google/tf2-preview/gnews-swivel-20dim-with-oov/1">https://tfhub.dev/google/tf2-preview/gnews-swivel-20dim-with-oov/1</a></p></li>
<li><p>Pretrained model path/url</p></li>
</ul>
</li>
<li><p>optimizer: String</p>
<ul>
<li><p>default: adam</p></li>
<li><p>Optimizer used by model</p></li>
</ul>
</li>
<li><p>metrics: String</p>
<ul>
<li><p>default: accuracy</p></li>
<li><p>Metric used to evaluate model</p></li>
</ul>
</li>
<li><p>clstype: Type</p>
<ul>
<li><p>default: &lt;class ‘str’&gt;</p></li>
<li><p>Data type of classifications values</p></li>
</ul>
</li>
<li><p>epochs: Integer</p>
<ul>
<li><p>default: 10</p></li>
<li><p>Number of iterations to pass over all records in a source</p></li>
</ul>
</li>
<li><p>directory: Path</p>
<ul>
<li><p>default: ~/.cache/dffml/tensorflow_hub</p></li>
<li><p>Directory where state should be saved</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="dffml-model-transformers">
<span id="plugin-model-dffml-model-transformers"></span><h2>dffml_model_transformers<a class="headerlink" href="#dffml-model-transformers" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pip install dffml-model-transformers</span>
</pre></div>
</div>
<div class="section" id="ner-tagger">
<span id="plugin-model-dffml-model-transformers-ner-tagger"></span><h3>ner_tagger<a class="headerlink" href="#ner-tagger" title="Permalink to this headline">¶</a></h3>
<p><em>Official</em></p>
<p>Implemented using ![HuggingFace Transformers](<a class="reference external" href="https://huggingface.co/transformers/index.html">https://huggingface.co/transformers/index.html</a>) Tensorflow based Models.
Description about pretrianed models can be found ![here](<a class="reference external" href="https://huggingface.co/transformers/pretrained_models.html">https://huggingface.co/transformers/pretrained_models.html</a>)</p>
<p>First we create the training and testing datasets</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">&gt;</span> <span class="n">train</span><span class="o">.</span><span class="n">csv</span> <span class="o">&lt;&lt;</span> <span class="n">EOF</span>
<span class="n">SentenceId</span><span class="p">,</span><span class="n">Words</span><span class="p">,</span><span class="n">Tag</span>
<span class="mi">1</span><span class="p">,</span><span class="n">DFFML</span><span class="p">,</span><span class="n">B</span><span class="o">-</span><span class="n">MISC</span>
<span class="mi">1</span><span class="p">,</span><span class="n">Models</span><span class="p">,</span><span class="n">I</span><span class="o">-</span><span class="n">MISC</span>
<span class="mi">1</span><span class="p">,</span><span class="n">are</span><span class="p">,</span><span class="n">O</span>
<span class="mi">1</span><span class="p">,</span><span class="n">cool</span><span class="p">,</span><span class="n">B</span><span class="o">-</span><span class="n">MISC</span>
<span class="mi">2</span><span class="p">,</span><span class="n">DFFML</span><span class="p">,</span><span class="n">B</span><span class="o">-</span><span class="n">MISC</span>
<span class="mi">2</span><span class="p">,</span><span class="n">Models</span><span class="p">,</span><span class="n">I</span><span class="o">-</span><span class="n">MISC</span>
<span class="mi">2</span><span class="p">,</span><span class="n">can</span><span class="p">,</span><span class="n">O</span>
<span class="mi">2</span><span class="p">,</span><span class="n">do</span><span class="p">,</span><span class="n">O</span>
<span class="mi">2</span><span class="p">,</span><span class="n">classification</span><span class="p">,</span><span class="n">B</span><span class="o">-</span><span class="n">MISC</span>
<span class="n">EOF</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">&gt;</span> <span class="n">test</span><span class="o">.</span><span class="n">csv</span> <span class="o">&lt;&lt;</span> <span class="n">EOF</span>
<span class="n">SentenceId</span><span class="p">,</span><span class="n">Words</span>
<span class="mi">1</span><span class="p">,</span><span class="n">DFFML</span> <span class="n">models</span> <span class="n">can</span> <span class="n">do</span> <span class="n">NER</span>
<span class="mi">2</span><span class="p">,</span><span class="n">DFFML</span> <span class="n">models</span> <span class="n">can</span> <span class="n">do</span> <span class="n">regression</span>
<span class="n">EOF</span>
</pre></div>
</div>
<p>Train the model</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dffml</span> <span class="n">train</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">ner_tagger</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">epochs</span> <span class="mi">2</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">s</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="n">train</span><span class="o">.</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">sid</span> <span class="n">SentenceId</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">words</span> <span class="n">Words</span><span class="p">:</span><span class="nb">str</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">Tag</span><span class="p">:</span><span class="nb">str</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">model_architecture_type</span> <span class="n">bert</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">model_name_or_path</span> <span class="n">bert</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="n">cased</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">no_cuda</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">save_steps</span> <span class="mi">1</span> \
  <span class="o">-</span><span class="n">log</span> <span class="n">debug</span>
</pre></div>
</div>
<p>Assess the accuracy</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dffml</span> <span class="n">accuracy</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">ner_tagger</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">s</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="n">train</span><span class="o">.</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">sid</span> <span class="n">SentenceId</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">words</span> <span class="n">Words</span><span class="p">:</span><span class="nb">str</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">Tag</span><span class="p">:</span><span class="nb">str</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">model_architecture_type</span> <span class="n">bert</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">model_name_or_path</span> <span class="n">bert</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="n">cased</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">no_cuda</span> \
  <span class="o">-</span><span class="n">log</span> <span class="n">debug</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>            <span class="n">precision</span>    <span class="n">recall</span>  <span class="n">f1</span><span class="o">-</span><span class="n">score</span>   <span class="n">support</span>

    <span class="n">MISC</span>     <span class="mf">0.0000</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>         <span class="mi">2</span>

<span class="n">micro</span> <span class="n">avg</span>     <span class="mf">0.0000</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>         <span class="mi">2</span>
<span class="n">macro</span> <span class="n">avg</span>     <span class="mf">0.0000</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>         <span class="mi">2</span>

<span class="n">INFO</span><span class="p">:</span><span class="n">dffml</span><span class="o">.</span><span class="n">NERModelContext</span><span class="p">:</span><span class="n">final_loss</span> <span class="o">=</span> <span class="mf">1.4586552</span>
<span class="mf">0.0</span>
</pre></div>
</div>
<p>Make a prediction</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dffml</span> <span class="n">predict</span> <span class="nb">all</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">ner_tagger</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">s</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="n">test</span><span class="o">.</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">sid</span> <span class="n">SentenceId</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">words</span> <span class="n">Words</span><span class="p">:</span><span class="nb">str</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">Tag</span><span class="p">:</span><span class="nb">str</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">model_architecture_type</span> <span class="n">bert</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">model_name_or_path</span> <span class="n">bert</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="n">cased</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">no_cuda</span> \
  <span class="o">-</span><span class="n">log</span> <span class="n">debug</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span>[
    {
        &quot;extra&quot;: {},
        &quot;features&quot;: {
            &quot;SentenceId&quot;: 1,
            &quot;Words&quot;: &quot;DFFML models can do NER&quot;
        },
        &quot;key&quot;: &quot;0&quot;,
        &quot;last_updated&quot;: &quot;2020-03-21T23:14:41Z&quot;,
        &quot;prediction&quot;: {
            &quot;Tag&quot;: {
                &quot;confidence&quot;: NaN,
                &quot;value&quot;: [
                    [
                        {
                            &quot;DFFML&quot;: &quot;I-LOC&quot;
                        },
                        {
                            &quot;models&quot;: &quot;O&quot;
                        },
                        {
                            &quot;can&quot;: &quot;I-LOC&quot;
                        },
                        {
                            &quot;do&quot;: &quot;I-LOC&quot;
                        },
                        {
                            &quot;NER&quot;: &quot;I-LOC&quot;
                        }
                    ]
                ]
            }
        }
    },
    {
        &quot;extra&quot;: {},
        &quot;features&quot;: {
            &quot;SentenceId&quot;: 2,
            &quot;Words&quot;: &quot;DFFML models can do regression&quot;
        },
        &quot;key&quot;: &quot;1&quot;,
        &quot;last_updated&quot;: &quot;2020-03-21T23:14:42Z&quot;,
        &quot;prediction&quot;: {
            &quot;Tag&quot;: {
                &quot;confidence&quot;: NaN,
                &quot;value&quot;: [
                    [
                        {
                            &quot;DFFML&quot;: &quot;I-LOC&quot;
                        },
                        {
                            &quot;models&quot;: &quot;O&quot;
                        },
                        {
                            &quot;can&quot;: &quot;I-LOC&quot;
                        },
                        {
                            &quot;do&quot;: &quot;I-LOC&quot;
                        },
                        {
                            &quot;regression&quot;: &quot;I-LOC&quot;
                        }
                    ]
                ]
            }
        }
    }
]
</pre></div>
</div>
<p>The model can be trained on large datasets to get the expected
output. The example shown above is to demonstrate the commandline usage
of the model.</p>
<p>Example usage of NER model using python API</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dffml</span> <span class="kn">import</span> <span class="n">CSVSource</span><span class="p">,</span> <span class="n">DefFeature</span>
<span class="kn">from</span> <span class="nn">dffml.noasync</span> <span class="kn">import</span> <span class="n">train</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">predict</span>
<span class="kn">from</span> <span class="nn">dffml_model_transformers.ner.ner_model</span> <span class="kn">import</span> <span class="n">NERModel</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">NERModel</span><span class="p">(</span>
    <span class="n">sid</span><span class="o">=</span><span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;SentenceId&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">words</span><span class="o">=</span><span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;Words&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">predict</span><span class="o">=</span><span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;Tag&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">model_architecture_type</span><span class="o">=</span><span class="s2">&quot;distilbert&quot;</span><span class="p">,</span>
    <span class="n">model_name_or_path</span><span class="o">=</span><span class="s2">&quot;distilbert-base-cased&quot;</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">no_cuda</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Train the model</span>
<span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;train.csv&quot;</span><span class="p">)</span>

<span class="c1"># Assess accuracy (alternate way of specifying data source)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy:&quot;</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">CSVSource</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;train.csv&quot;</span><span class="p">)))</span>

<span class="c1"># Make prediction</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">predict</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="p">{</span><span class="s2">&quot;SentenceID&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Words&quot;</span><span class="p">:</span> <span class="s2">&quot;DFFML models can do NER&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;SentenceID&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Words&quot;</span><span class="p">:</span> <span class="s2">&quot;DFFML models can do regression&quot;</span><span class="p">},</span>
<span class="p">):</span>
    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;Tag&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">[</span><span class="s2">&quot;Tag&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Args</strong></p>
<ul class="simple">
<li><p>sid: Feature</p>
<ul>
<li><p>Unique Id to identify words of each sentence (Sentence ID)</p></li>
</ul>
</li>
<li><p>words: Feature</p>
<ul>
<li><p>Tokens to train NER model</p></li>
</ul>
</li>
<li><p>predict: Feature</p>
<ul>
<li><p>NER Tags (B-MISC, I-PER, O etc.) for tokens</p></li>
</ul>
</li>
<li><p>model_architecture_type: String</p>
<ul>
<li><p>Model architecture selected in the : bert, distilbert, roberta</p></li>
</ul>
</li>
<li><p>model_name_or_path: String</p>
<ul>
<li><p>Path to pre-trained model or shortcut name selected in the list: bert-base-uncased, bert-large-uncased, bert-base-cased, bert-large-cased, bert-base-multilingual-uncased, bert-base-multilingual-cased, bert-base-chinese, bert-base-german-cased, bert-large-uncased-whole-word-masking, bert-large-cased-whole-word-masking, bert-large-uncased-whole-word-masking-finetuned-squad, bert-large-cased-whole-word-masking-finetuned-squad, bert-base-cased-finetuned-mrpc, bert-base-german-dbmdz-cased, bert-base-german-dbmdz-uncased, bert-base-japanese, bert-base-japanese-whole-word-masking, bert-base-japanese-char, bert-base-japanese-char-whole-word-masking, bert-base-finnish-cased-v1, bert-base-finnish-uncased-v1, bert-base-dutch-cased, roberta-base, roberta-large, roberta-large-mnli, distilroberta-base, roberta-base-openai-detector, roberta-large-openai-detector, distilbert-base-uncased, distilbert-base-uncased-distilled-squad, distilbert-base-cased, distilbert-base-cased-distilled-squad, distilbert-base-german-cased, distilbert-base-multilingual-cased, distilbert-base-uncased-finetuned-sst-2-english</p></li>
</ul>
</li>
<li><p>output_dir: String</p>
<ul>
<li><p>default: ~/.cache/dffml/transformers/checkpoints</p></li>
<li><p>The output directory where the model checkpoints will be written</p></li>
</ul>
</li>
<li><p>config_name: String</p>
<ul>
<li><p>default: None</p></li>
<li><p>Pretrained config name or path if not the same as model_name</p></li>
</ul>
</li>
<li><p>tokenizer_name: String</p>
<ul>
<li><p>default: None</p></li>
<li><p>Pretrained tokenizer name or path if not the same as model_name</p></li>
</ul>
</li>
<li><p>cache_dir: String</p>
<ul>
<li><p>default: ~/.cache/dffml/transformers</p></li>
<li><p>Directory to store the pre-trained models downloaded from s3</p></li>
</ul>
</li>
<li><p>max_seq_length: Integer</p>
<ul>
<li><p>default: 128</p></li>
<li><p>The maximum total input sentence length after tokenization.Sequences longer than this will be truncated, sequences shorter will be padded</p></li>
</ul>
</li>
<li><p>max_steps: Integer</p>
<ul>
<li><p>default: 0</p></li>
<li><p>If greater than zero then sets total number of training steps to perform. Overrides <cite>epochs</cite></p></li>
</ul>
</li>
<li><p>use_fp16: Boolean</p>
<ul>
<li><p>default: False</p></li>
<li><p>Whether to use 16-bit (mixed) precision instead of 32-bit</p></li>
</ul>
</li>
<li><p>ner_tags: List of strings</p>
<ul>
<li><p>default: [‘O’, ‘B-MISC’, ‘I-MISC’, ‘B-PER’, ‘I-PER’, ‘B-ORG’, ‘I-ORG’, ‘B-LOC’, ‘I-LOC’]</p></li>
<li><p>List of all distinct NER Tags</p></li>
</ul>
</li>
<li><p>do_lower_case: Boolean</p>
<ul>
<li><p>default: False</p></li>
<li><p>Set this flag if using uncased model.</p></li>
</ul>
</li>
<li><p>gradient_accumulation_steps: Integer</p>
<ul>
<li><p>default: 1</p></li>
<li><p>Number of updates steps to accumulate before performing a backward pass.</p></li>
</ul>
</li>
<li><p>learning_rate: float</p>
<ul>
<li><p>default: 5e-05</p></li>
<li><p>The initial learning rate for Adam</p></li>
</ul>
</li>
<li><p>weight_decay: float</p>
<ul>
<li><p>default: 0.0</p></li>
<li><p>Weight decay</p></li>
</ul>
</li>
<li><p>adam_epsilon: float</p>
<ul>
<li><p>default: 1e-08</p></li>
<li><p>Epsilon for Adam optimizer</p></li>
</ul>
</li>
<li><p>max_grad_norm: float</p>
<ul>
<li><p>default: 1.0</p></li>
<li><p>Max gradient norm.</p></li>
</ul>
</li>
<li><p>epochs: Integer</p>
<ul>
<li><p>default: 1</p></li>
<li><p>Total number of training epochs to perform.</p></li>
</ul>
</li>
<li><p>warmup_steps: Integer</p>
<ul>
<li><p>default: 0</p></li>
<li><p>Linear warmup over warmup_steps.</p></li>
</ul>
</li>
<li><p>save_steps: Integer</p>
<ul>
<li><p>default: 10</p></li>
<li><p>Save checkpoint every X update steps.</p></li>
</ul>
</li>
<li><p>seed: Integer</p>
<ul>
<li><p>default: 2020</p></li>
<li><p>Random seed for initialization</p></li>
</ul>
</li>
<li><p>gpus: String</p>
<ul>
<li><p>default: 0</p></li>
<li><p>List of gpu devices. If only one, switch to single gpu strategy, if None takes all availabel gpus</p></li>
</ul>
</li>
<li><p>tpu: String</p>
<ul>
<li><p>default: None</p></li>
<li><p>The Cloud TPU to use for training. This should be either the name used when creating the Cloud TPU, or a grpc://ip.address.of.tpu:8470 url</p></li>
</ul>
</li>
<li><p>num_tpu_cores: Integer</p>
<ul>
<li><p>default: 8</p></li>
<li><p>Total number of TPU cores to use.</p></li>
</ul>
</li>
<li><p>per_device_train_batch_size: Integer</p>
<ul>
<li><p>default: 8</p></li>
<li><p>Batch size per GPU/CPU/TPU for training</p></li>
</ul>
</li>
<li><p>per_device_eval_batch_size: Integer</p>
<ul>
<li><p>default: 8</p></li>
<li><p>Batch size per GPU/CPU/TPU for assessing accuracy</p></li>
</ul>
</li>
<li><p>no_cuda: Boolean</p>
<ul>
<li><p>default: False</p></li>
<li><p>Avoid using CUDA when available</p></li>
</ul>
</li>
<li><p>eval_all_checkpoints: Boolean</p>
<ul>
<li><p>default: False</p></li>
<li><p>Evaluate all checkpoints starting with the same prefix as model_name ending and ending with step number</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="dffml-model-scratch">
<span id="plugin-model-dffml-model-scratch"></span><h2>dffml_model_scratch<a class="headerlink" href="#dffml-model-scratch" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pip install dffml-model-scratch</span>
</pre></div>
</div>
<div class="section" id="scratchlgrsag">
<span id="plugin-model-dffml-model-scratch-scratchlgrsag"></span><h3>scratchlgrsag<a class="headerlink" href="#scratchlgrsag" title="Permalink to this headline">¶</a></h3>
<p><em>Official</em></p>
<p>Logistic Regression using stochastic average gradient descent optimizer</p>
<p>The dataset used for training</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">&gt;</span> <span class="n">dataset</span><span class="o">.</span><span class="n">csv</span> <span class="o">&lt;&lt;</span> <span class="n">EOF</span>
<span class="n">f1</span><span class="p">,</span><span class="n">ans</span>
<span class="mf">0.1</span><span class="p">,</span><span class="mi">0</span>
<span class="mf">0.7</span><span class="p">,</span><span class="mi">1</span>
<span class="mf">0.6</span><span class="p">,</span><span class="mi">1</span>
<span class="mf">0.2</span><span class="p">,</span><span class="mi">0</span>
<span class="mf">0.8</span><span class="p">,</span><span class="mi">1</span>
<span class="n">EOF</span>
</pre></div>
</div>
<p>Train the model</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dffml</span> <span class="n">train</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">scratchlgrsag</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">features</span> <span class="n">f1</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">ans</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">f</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="n">dataset</span><span class="o">.</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">log</span> <span class="n">debug</span>
</pre></div>
</div>
<p>Assess the accuracy</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dffml</span> <span class="n">accuracy</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">scratchlgrsag</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">features</span> <span class="n">f1</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">ans</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">f</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="n">dataset</span><span class="o">.</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">log</span> <span class="n">debug</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">1.0</span>
</pre></div>
</div>
<p>Make a prediction</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="o">-</span><span class="n">e</span> <span class="s1">&#39;f1,ans</span><span class="se">\n</span><span class="s1">0.8,0</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">|</span> \
  <span class="n">dffml</span> <span class="n">predict</span> <span class="nb">all</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">scratchlgrsag</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">features</span> <span class="n">f1</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">ans</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">f</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">stdin</span> \
  <span class="o">-</span><span class="n">log</span> <span class="n">debug</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[</span>
<span class="go">    {</span>
<span class="go">        &quot;extra&quot;: {},</span>
<span class="go">        &quot;features&quot;: {</span>
<span class="go">            &quot;ans&quot;: 0,</span>
<span class="go">            &quot;f1&quot;: 0.8</span>
<span class="go">        },</span>
<span class="go">        &quot;last_updated&quot;: &quot;2020-03-19T13:41:08Z&quot;,</span>
<span class="go">        &quot;prediction&quot;: {</span>
<span class="go">            &quot;ans&quot;: {</span>
<span class="go">                &quot;confidence&quot;: 1.0,</span>
<span class="go">                &quot;value&quot;: 1</span>
<span class="go">            }</span>
<span class="go">        },</span>
<span class="go">        &quot;key&quot;: &quot;0&quot;</span>
<span class="go">    }</span>
<span class="go">]</span>
</pre></div>
</div>
<p>Example usage of Logistic Regression using Python</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dffml</span> <span class="kn">import</span> <span class="n">CSVSource</span><span class="p">,</span> <span class="n">Features</span><span class="p">,</span> <span class="n">DefFeature</span>
<span class="kn">from</span> <span class="nn">dffml.noasync</span> <span class="kn">import</span> <span class="n">train</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">predict</span>
<span class="kn">from</span> <span class="nn">dffml_model_scratch.logisticregression</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span>
    <span class="n">features</span><span class="o">=</span><span class="n">Features</span><span class="p">(</span><span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;f1&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
    <span class="n">predict</span><span class="o">=</span><span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;ans&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Train the model</span>
<span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;dataset.csv&quot;</span><span class="p">)</span>

<span class="c1"># Assess accuracy (alternate way of specifying data source)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy:&quot;</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">CSVSource</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;dataset.csv&quot;</span><span class="p">)))</span>

<span class="c1"># Make prediction</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;f1&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s2">&quot;ans&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}):</span>
    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;ans&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">[</span><span class="s2">&quot;ans&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Args</strong></p>
<ul class="simple">
<li><p>predict: Feature</p>
<ul>
<li><p>Label or the value to be predicted</p></li>
</ul>
</li>
<li><p>features: List of features</p>
<ul>
<li><p>Features to train on</p></li>
</ul>
</li>
<li><p>directory: Path</p>
<ul>
<li><p>default: ~/.cache/dffml/scratch</p></li>
<li><p>Directory where state should be saved</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="dffml-model-scikit">
<span id="plugin-model-dffml-model-scikit"></span><h2>dffml_model_scikit<a class="headerlink" href="#dffml-model-scikit" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pip install dffml-model-scikit</span>
</pre></div>
</div>
<p>Machine Learning models implemented with <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a>.
Models are saved under the directory in subdirectories named after the hash of
their feature names.</p>
<p><strong>General Usage:</strong></p>
<p>Training:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>dffml train <span class="se">\</span>
<span class="go">    -model SCIKIT_MODEL_ENTRYPOINT \</span>
<span class="go">    -model-features FEATURE_DEFINITION \</span>
<span class="go">    -model-predict TO_PREDICT \</span>
<span class="go">    -model-SCIKIT_PARAMETER_NAME SCIKIT_PARAMETER_VALUE \</span>
<span class="go">    -sources f=TRAINING_DATA_SOURCE_TYPE \</span>
<span class="go">    -source-filename TRAINING_DATA_FILE_NAME \</span>
<span class="go">    -log debug</span>
</pre></div>
</div>
<p>Testing and Accuracy:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>dffml accuracy <span class="se">\</span>
<span class="go">    -model SCIKIT_MODEL_ENTRYPOINT \</span>
<span class="go">    -model-features FEATURE_DEFINITION \</span>
<span class="go">    -model-predict TO_PREDICT \</span>
<span class="go">    -sources f=TESTING_DATA_SOURCE_TYPE \</span>
<span class="go">    -source-filename TESTING_DATA_FILE_NAME \</span>
<span class="go">    -log debug</span>
</pre></div>
</div>
<p>Predicting with trained model:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>dffml predict all <span class="se">\</span>
<span class="go">    -model SCIKIT_MODEL_ENTRYPOINT \</span>
<span class="go">    -model-features FEATURE_DEFINITION \</span>
<span class="go">    -model-predict TO_PREDICT \</span>
<span class="go">    -sources f=PREDICT_DATA_SOURCE_TYPE \</span>
<span class="go">    -source-filename PREDICT_DATA_FILE_NAME \</span>
<span class="go">    -log debug</span>
</pre></div>
</div>
<p><strong>Models Available:</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 6%" />
<col style="width: 12%" />
<col style="width: 6%" />
<col style="width: 75%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Model</p></th>
<th class="head"><p>Entrypoint</p></th>
<th class="head"><p>Parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="11"><p>Regression</p></td>
<td><p>LinearRegression</p></td>
<td><p>scikitlr</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html#sklearn.linear_model.LinearRegression/">scikitlr</a></p></td>
</tr>
<tr class="row-odd"><td><p>ElasticNet</p></td>
<td><p>scikiteln</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.ElasticNet.html#sklearn.linear_model.ElasticNet/">scikiteln</a></p></td>
</tr>
<tr class="row-even"><td><p>BayesianRidge</p></td>
<td><p>scikitbyr</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.BayesianRidge.html#sklearn.linear_model.BayesianRidge/">scikitbyr</a></p></td>
</tr>
<tr class="row-odd"><td><p>Lasso</p></td>
<td><p>scikitlas</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Lasso.html#sklearn.linear_model.Lasso/">scikitlas</a></p></td>
</tr>
<tr class="row-even"><td><p>ARDRegression</p></td>
<td><p>scikitard</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.ARDRegression.html#sklearn.linear_model.ARDRegression/">scikitard</a></p></td>
</tr>
<tr class="row-odd"><td><p>RANSACRegressor</p></td>
<td><p>scikitrsc</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.RANSACRegressor.html#sklearn.linear_model.RANSACRegressor/">scikitrsc</a></p></td>
</tr>
<tr class="row-even"><td><p>DecisionTreeRegressor</p></td>
<td><p>scikitdtr</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeRegressor.html#sklearn.tree.DecisionTreeRegressor/">scikitdtr</a></p></td>
</tr>
<tr class="row-odd"><td><p>GaussianProcessRegressor</p></td>
<td><p>scikitgpr</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.gaussian_process.GaussianProcessRegressor.html#sklearn.gaussian_process.GaussianProcessRegressor/">scikitgpr</a></p></td>
</tr>
<tr class="row-even"><td><p>OrthogonalMatchingPursuit</p></td>
<td><p>scikitomp</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.OrthogonalMatchingPursuit.html#sklearn.linear_model.OrthogonalMatchingPursuit/">scikitomp</a></p></td>
</tr>
<tr class="row-odd"><td><p>Lars</p></td>
<td><p>scikitlars</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Lars.html#sklearn.linear_model.Lars/">scikitlars</a></p></td>
</tr>
<tr class="row-even"><td><p>Ridge</p></td>
<td><p>scikitridge</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Ridge.html#sklearn.linear_model.Ridge/">scikitridge</a></p></td>
</tr>
<tr class="row-odd"><td rowspan="16"><p>Classification</p></td>
<td><p>KNeighborsClassifier</p></td>
<td><p>scikitknn</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html#sklearn.neighbors.KNeighborsClassifier/">scikitknn</a></p></td>
</tr>
<tr class="row-even"><td><p>AdaBoostClassifier</p></td>
<td><p>scikitadaboost</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.AdaBoostClassifier.html#sklearn.ensemble.AdaBoostClassifier/">scikitadaboost</a></p></td>
</tr>
<tr class="row-odd"><td><p>GaussianProcessClassifier</p></td>
<td><p>scikitgpc</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.gaussian_process.GaussianProcessClassifier.html#sklearn.gaussian_process.GaussianProcessClassifier/">scikitgpc</a></p></td>
</tr>
<tr class="row-even"><td><p>DecisionTreeClassifier</p></td>
<td><p>scikitdtc</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html#sklearn.tree.DecisionTreeClassifier/">scikitdtc</a></p></td>
</tr>
<tr class="row-odd"><td><p>RandomForestClassifier</p></td>
<td><p>scikitrfc</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html#sklearn.ensemble.RandomForestClassifier/">scikitrfc</a></p></td>
</tr>
<tr class="row-even"><td><p>QuadraticDiscriminantAnalysis</p></td>
<td><p>scikitqda</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.discriminant_analysis.QuadraticDiscriminantAnalysis.html#sklearn.discriminant_analysis.QuadraticDiscriminantAnalysis/">scikitqda</a></p></td>
</tr>
<tr class="row-odd"><td><p>MLPClassifier</p></td>
<td><p>scikitmlp</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPClassifier.html#sklearn.neural_network.MLPClassifier/">scikitmlp</a></p></td>
</tr>
<tr class="row-even"><td><p>GaussianNB</p></td>
<td><p>scikitgnb</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.GaussianNB.html#sklearn.naive_bayes.GaussianNB/">scikitgnb</a></p></td>
</tr>
<tr class="row-odd"><td><p>SVC</p></td>
<td><p>scikitsvc</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC/">scikitsvc</a></p></td>
</tr>
<tr class="row-even"><td><p>LogisticRegression</p></td>
<td><p>scikitlor</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html#sklearn.linear_model.LogisticRegression/">scikitlor</a></p></td>
</tr>
<tr class="row-odd"><td><p>GradientBoostingClassifier</p></td>
<td><p>scikitgbc</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html#sklearn.ensemble.GradientBoostingClassifier/">scikitgbc</a></p></td>
</tr>
<tr class="row-even"><td><p>BernoulliNB</p></td>
<td><p>scikitbnb</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.BernoulliNB.html#sklearn.naive_bayes.BernoulliNB/">scikitbnb</a></p></td>
</tr>
<tr class="row-odd"><td><p>ExtraTreesClassifier</p></td>
<td><p>scikitetc</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.ExtraTreesClassifier.html#sklearn.ensemble.ExtraTreesClassifier/">scikitetc</a></p></td>
</tr>
<tr class="row-even"><td><p>BaggingClassifier</p></td>
<td><p>scikitbgc</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.BaggingClassifier.html#sklearn.ensemble.BaggingClassifier/">scikitbgc</a></p></td>
</tr>
<tr class="row-odd"><td><p>LinearDiscriminantAnalysis</p></td>
<td><p>scikitlda</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.discriminant_analysis.LinearDiscriminantAnalysis.html#sklearn.discriminant_analysis.LinearDiscriminantAnalysis/">scikitlda</a></p></td>
</tr>
<tr class="row-even"><td><p>MultinomialNB</p></td>
<td><p>scikitmnb</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.MultinomialNB.html#sklearn.naive_bayes.MultinomialNB/">scikitmnb</a></p></td>
</tr>
<tr class="row-odd"><td rowspan="8"><p>Clustering</p></td>
<td><p>KMeans</p></td>
<td><p>scikitkmeans</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html#sklearn.cluster.KMeans/">scikitkmeans</a></p></td>
</tr>
<tr class="row-even"><td><p>Birch</p></td>
<td><p>scikitbirch</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.Birch.html#sklearn.cluster.Birch/">scikitbirch</a></p></td>
</tr>
<tr class="row-odd"><td><p>MiniBatchKMeans</p></td>
<td><p>scikitmbkmeans</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.MiniBatchKMeans.html#sklearn.cluster.MiniBatchKMeans/">scikitmbkmeans</a></p></td>
</tr>
<tr class="row-even"><td><p>AffinityPropagation</p></td>
<td><p>scikitap</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.AffinityPropagation.html#sklearn.cluster.AffinityPropagation/">scikitap</a></p></td>
</tr>
<tr class="row-odd"><td><p>MeanShift</p></td>
<td><p>scikitms</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.MeanShift.html#sklearn.cluster.MeanShift/">scikitms</a></p></td>
</tr>
<tr class="row-even"><td><p>SpectralClustering</p></td>
<td><p>scikitsc</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.SpectralClustering.html#sklearn.cluster.SpectralClustering/">scikitsc</a></p></td>
</tr>
<tr class="row-odd"><td><p>AgglomerativeClustering</p></td>
<td><p>scikitac</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.AgglomerativeClustering.html#sklearn.cluster.AgglomerativeClustering/">scikitac</a></p></td>
</tr>
<tr class="row-even"><td><p>OPTICS</p></td>
<td><p>scikitoptics</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.OPTICS.html#sklearn.cluster.OPTICS/">scikitoptics</a></p></td>
</tr>
</tbody>
</table>
<p><strong>Usage Example:</strong></p>
<p>Example below uses LinearRegression Model using the command line.</p>
<p>Let us take a simple example:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 39%" />
<col style="width: 21%" />
<col style="width: 25%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Years of Experience</p></th>
<th class="head"><p>Expertise</p></th>
<th class="head"><p>Trust Factor</p></th>
<th class="head"><p>Salary</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>01</p></td>
<td><p>0.2</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>03</p></td>
<td><p>0.4</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>05</p></td>
<td><p>0.6</p></td>
<td><p>30</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>07</p></td>
<td><p>0.8</p></td>
<td><p>40</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>09</p></td>
<td><p>1.0</p></td>
<td><p>50</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>11</p></td>
<td><p>1.2</p></td>
<td><p>60</p></td>
</tr>
</tbody>
</table>
<p>First we create the files</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">&gt;</span> <span class="n">train</span><span class="o">.</span><span class="n">csv</span> <span class="o">&lt;&lt;</span> <span class="n">EOF</span>
<span class="n">Years</span><span class="p">,</span><span class="n">Expertise</span><span class="p">,</span><span class="n">Trust</span><span class="p">,</span><span class="n">Salary</span>
<span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">10</span>
<span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">20</span>
<span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">30</span>
<span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mi">40</span>
<span class="n">EOF</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">&gt;</span> <span class="n">test</span><span class="o">.</span><span class="n">csv</span> <span class="o">&lt;&lt;</span> <span class="n">EOF</span>
<span class="n">Years</span><span class="p">,</span><span class="n">Expertise</span><span class="p">,</span><span class="n">Trust</span><span class="p">,</span><span class="n">Salary</span>
<span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">50</span>
<span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mi">60</span>
<span class="n">EOF</span>
</pre></div>
</div>
<p>Train the model</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dffml</span> <span class="n">train</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">scikitlr</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">features</span> <span class="n">Years</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> <span class="n">Expertise</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> <span class="n">Trust</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">Salary</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">f</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="n">train</span><span class="o">.</span><span class="n">csv</span>
</pre></div>
</div>
<p>Assess accuracy</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dffml</span> <span class="n">accuracy</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">scikitlr</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">features</span> <span class="n">Years</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> <span class="n">Expertise</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> <span class="n">Trust</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">Salary</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">f</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="n">test</span><span class="o">.</span><span class="n">csv</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.0</span>
</pre></div>
</div>
<p>Make a prediction</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="o">-</span><span class="n">e</span> <span class="s1">&#39;Years,Expertise,Trust</span><span class="se">\n</span><span class="s1">6,13,0.7</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">|</span> \
<span class="n">dffml</span> <span class="n">predict</span> <span class="nb">all</span> \
  <span class="o">-</span><span class="n">model</span> <span class="n">scikitlr</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">features</span> <span class="n">Years</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> <span class="n">Expertise</span><span class="p">:</span><span class="nb">int</span><span class="p">:</span><span class="mi">1</span> <span class="n">Trust</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">predict</span> <span class="n">Salary</span><span class="p">:</span><span class="nb">float</span><span class="p">:</span><span class="mi">1</span> \
  <span class="o">-</span><span class="n">sources</span> <span class="n">f</span><span class="o">=</span><span class="n">csv</span> \
  <span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">filename</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">stdin</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
    <span class="p">{</span>
        <span class="nt">&quot;extra&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="nt">&quot;features&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;Expertise&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
            <span class="nt">&quot;Trust&quot;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
            <span class="nt">&quot;Years&quot;</span><span class="p">:</span> <span class="mi">6</span>
        <span class="p">},</span>
        <span class="nt">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;last_updated&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-03-01T22:26:46Z&quot;</span><span class="p">,</span>
        <span class="nt">&quot;prediction&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;Salary&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;confidence&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="mf">70.0</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Example usage of Linear Regression Model using python API:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dffml</span> <span class="kn">import</span> <span class="n">CSVSource</span><span class="p">,</span> <span class="n">Features</span><span class="p">,</span> <span class="n">DefFeature</span>
<span class="kn">from</span> <span class="nn">dffml.noasync</span> <span class="kn">import</span> <span class="n">train</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">predict</span>
<span class="kn">from</span> <span class="nn">dffml_model_scikit</span> <span class="kn">import</span> <span class="n">LinearRegressionModel</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span>
    <span class="n">features</span><span class="o">=</span><span class="n">Features</span><span class="p">(</span>
        <span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;Years&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;Expertise&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;Trust&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">),</span>
    <span class="n">predict</span><span class="o">=</span><span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;Salary&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Train the model</span>
<span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;train.csv&quot;</span><span class="p">)</span>

<span class="c1"># Assess accuracy (alternate way of specifying data source)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy:&quot;</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">CSVSource</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;test.csv&quot;</span><span class="p">)))</span>

<span class="c1"># Make prediction</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">predict</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="p">{</span><span class="s2">&quot;Years&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;Expertise&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span> <span class="s2">&quot;Trust&quot;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;Years&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;Expertise&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;Trust&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span>
<span class="p">):</span>
    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;Salary&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">[</span><span class="s2">&quot;Salary&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
<p>Example below uses KMeans Clustering Model on a small randomly generated dataset.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"> $ </span>cat &gt; train.csv &lt;&lt; EOF
<span class="go">Col1,          Col2,        Col3,         Col4</span>
<span class="go">5.05776417,   8.55128116,   6.15193196,  -8.67349666</span>
<span class="go">3.48864265,  -7.25952218,  -4.89216256,   4.69308946</span>
<span class="go">-8.16207603,  5.16792984,  -2.66971993,   0.2401882</span>
<span class="go">6.09809669,   8.36434181,   6.70940915,  -7.91491768</span>
<span class="go">-9.39122566,  5.39133807,  -2.29760281,  -1.69672981</span>
<span class="go">0.48311336,   8.19998973,   7.78641979,   7.8843821</span>
<span class="go">2.22409135,  -7.73598586,  -4.02660224,   2.82101794</span>
<span class="go">2.8137247 ,   8.36064298,   7.66196849,   3.12704676</span>
<span class="go">EOF</span>
<span class="gp"> $ </span>cat &gt; test.csv &lt;&lt; EOF
<span class="go">Col1,             Col2,          Col3,         Col4,    cluster</span>
<span class="go">-10.16770144,   2.73057215,  -1.49351481,   2.43005691,    6</span>
<span class="go">3.59705381,  -4.76520663,  -3.34916068,   5.72391486,     1</span>
<span class="go">4.01612313,  -4.641852  ,  -4.77333308,   5.87551683,     0</span>
<span class="go">EOF</span>
<span class="gp"> $ </span>dffml train <span class="se">\</span>
<span class="go">     -model scikitkmeans \</span>
<span class="go">     -model-features Col1:float:1 Col2:float:1 Col3:float:1 Col4:float:1 \</span>
<span class="go">     -sources f=csv \</span>
<span class="go">     -source-filename train.csv \</span>
<span class="go">     -source-readonly \</span>
<span class="go">     -log debug</span>
<span class="gp"> $ </span>dffml accuracy <span class="se">\</span>
<span class="go">     -model scikitkmeans \</span>
<span class="go">     -model-features Col1:float:1 Col2:float:1 Col3:float:1 Col4:float:1\</span>
<span class="go">     -model-tcluster cluster:int:1 \</span>
<span class="go">     -sources f=csv \</span>
<span class="go">     -source-filename test.csv \</span>
<span class="go">     -source-readonly \</span>
<span class="go">     -log debug</span>
<span class="go"> 0.6365141682948129</span>
<span class="gp"> $ </span><span class="nb">echo</span> -e <span class="s1">&#39;Col1,Col2,Col3,Col4\n6.09809669,8.36434181,6.70940915,-7.91491768\n&#39;</span> <span class="p">|</span> <span class="se">\</span>
<span class="go">   dffml predict all \</span>
<span class="go">     -model scikitkmeans \</span>
<span class="go">     -model-features Col1:float:1 Col2:float:1 Col3:float:1 Col4:float:1 \</span>
<span class="go">     -sources f=csv \</span>
<span class="go">     -source-filename /dev/stdin \</span>
<span class="go">     -source-readonly \</span>
<span class="go">     -log debug</span>
<span class="go"> [</span>
<span class="go">     {</span>
<span class="go">         &quot;extra&quot;: {},</span>
<span class="go">         &quot;features&quot;: {</span>
<span class="go">             &quot;Col1&quot;: 6.09809669,</span>
<span class="go">             &quot;Col2&quot;: 8.36434181,</span>
<span class="go">             &quot;Col3&quot;: 6.70940915,</span>
<span class="go">             &quot;Col4&quot;: -7.91491768</span>
<span class="go">         },</span>
<span class="go">         &quot;last_updated&quot;: &quot;2020-01-12T22:51:15Z&quot;,</span>
<span class="go">         &quot;prediction&quot;: {</span>
<span class="go">             &quot;confidence&quot;: 0.6365141682948129,</span>
<span class="go">             &quot;value&quot;: 2</span>
<span class="go">         },</span>
<span class="go">         &quot;key&quot;: &quot;0&quot;</span>
<span class="go">     }</span>
<span class="go"> ]</span>
</pre></div>
</div>
<p>Example usage of KMeans Clustering Model using python API:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dffml</span> <span class="kn">import</span> <span class="n">CSVSource</span><span class="p">,</span> <span class="n">Features</span><span class="p">,</span> <span class="n">DefFeature</span>
<span class="kn">from</span> <span class="nn">dffml.noasync</span> <span class="kn">import</span> <span class="n">train</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">predict</span>
<span class="kn">from</span> <span class="nn">dffml_model_scikit</span> <span class="kn">import</span> <span class="n">KMeansModel</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">KMeansModel</span><span class="p">(</span>
    <span class="n">features</span><span class="o">=</span><span class="n">Features</span><span class="p">(</span>
        <span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;Col1&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;Col2&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;Col3&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;Col4&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">),</span>
    <span class="n">tcluster</span><span class="o">=</span><span class="n">DefFeature</span><span class="p">(</span><span class="s2">&quot;cluster&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Train the model</span>
<span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;train.csv&quot;</span><span class="p">)</span>

<span class="c1"># Assess accuracy (alternate way of specifying data source)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy:&quot;</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">CSVSource</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;test.csv&quot;</span><span class="p">)))</span>

<span class="c1"># Make prediction</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">predict</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="p">{</span><span class="s2">&quot;Col1&quot;</span><span class="p">:</span> <span class="mf">6.09809669</span><span class="p">,</span> <span class="s2">&quot;Col2&quot;</span><span class="p">:</span> <span class="mf">8.36434181</span><span class="p">,</span> <span class="s2">&quot;Col3&quot;</span><span class="p">:</span> <span class="mf">6.70940915</span><span class="p">,</span> <span class="s2">&quot;Col4&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">7.91491768</span><span class="p">},</span>
<span class="p">):</span>
    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>NOTE</strong>: <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-transductive/">Transductive</a> Clusterers(scikitsc, scikitac, scikitoptics) cannot handle unseen data.
Ensure that <cite>predict</cite> and <cite>accuracy</cite> for these algorithms uses training data.</p>
<p><strong>Args</strong></p>
<ul class="simple">
<li><p>predict: Feature</p>
<ul>
<li><p>Label or the value to be predicted</p></li>
<li><p>Only used by classification and regression models</p></li>
</ul>
</li>
<li><p>tcluster: Feature</p>
<ul>
<li><p>True cluster, only used by clustering models</p></li>
<li><p>Passed with <cite>accuracy</cite> to return <cite>mutual_info_score</cite></p></li>
<li><p>If not passed <cite>accuracy</cite> returns <cite>silhouette_score</cite></p></li>
</ul>
</li>
<li><p>features: List of features</p>
<ul>
<li><p>Features to train on</p></li>
</ul>
</li>
<li><p>directory: Path</p>
<ul>
<li><p>default: ~/.cache/dffml/scikit-{entrypoint}</p></li>
<li><p>Directory where state should be saved</p></li>
</ul>
</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="dffml_operation.html" class="btn btn-neutral float-right" title="Operations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="dffml_source.html" class="btn btn-neutral float-left" title="Sources" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2019, Intel.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>