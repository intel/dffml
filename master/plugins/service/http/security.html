

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Security &mdash; DFFML fec5c65d6 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="JavaScript" href="javascript.html" />
    <link rel="prev" title="API" href="api.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> DFFML
          

          
          </a>

          
            
            
              <div class="version">
                fec5c65d6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../concepts/index.html">Concepts</a></li>
</ul>
<p class="caption"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart/model.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cli.html">Command Line</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">HTTP API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cli.html">Command Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataflow.html">DataFlow</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Security</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cors">CORS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#atomic-mode">Atomic Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multitenancy">Multitenancy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-network-etc-access">File, Network, Etc. Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="#authentication">Authentication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="javascript.html">JavaScript</a></li>
<li class="toctree-l2"><a class="reference internal" href="python.html">Python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/noasync.html">Noasync</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/base.html">Base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/record.html">Record</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/log.html">Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/high_level.html">High_Level</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/version.html">Version</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/source/index.html">Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/operation/index.html">Operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/feature/index.html">Feature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/cli/index.html">Cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/secret/index.html">Secret</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/df/index.html">Df</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/db/index.html">Db</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/service/index.html">Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/configloader/index.html">Configloader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/model/index.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/util/index.html">Util</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/port/index.html">Port</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../arch/index.html">Architecture</a></li>
</ul>
<p class="caption"><span class="caption-text">Subprojects</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../shouldi.html">shouldi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../swportal.html">Software Portal</a></li>
</ul>
<p class="caption"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/intel/dffml">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://intel.github.io/dffml/master/">Master Branch Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contact.html">Contact Us</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../news/index.html">News</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">DFFML</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">HTTP API</a> &raquo;</li>
        
      <li>Security</li>
    
    


      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/intel/dffml/blob/master/docs/plugins/service/http/security.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    


  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="security">
<h1>Security<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h1>
<p>Vulnerabilities should be reported via <a class="reference external" href="https://intel.com/security">https://intel.com/security</a></p>
<div class="section" id="cors">
<h2>CORS<a class="headerlink" href="#cors" title="Permalink to this headline">¶</a></h2>
<p>You’ll want to configure the domains that should be able to request the API via
the CORS flag, if you are putting this on a different domain.</p>
<p>For example if you are hosting the API service on
<code class="docutils literal notranslate"><span class="pre">https://dffml.example-api.com</span></code> and you’re web UI on
<code class="docutils literal notranslate"><span class="pre">https://dffml.example.com</span></code>, you’ll need to add the URL of the web UI to the
CORS list.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>dffml service http server -cors <span class="s1">&#39;https://dffml.example-api.com&#39;</span>
</pre></div>
</div>
<p>You may just want to throw all of this CORS buisness out the window when
developing (we don’t blame you). In which case you could enable connections from
all origins via <code class="docutils literal notranslate"><span class="pre">*</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>dffml service http server -cors <span class="s1">&#39;*&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="atomic-mode">
<h2>Atomic Mode<a class="headerlink" href="#atomic-mode" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-mc-atomic</span></code> flag will disable all routes other than those registered via
<code class="docutils literal notranslate"><span class="pre">-mc-config</span></code>. If you want the server to only respond using the specified
dataflows, and provide no other functionality, use this option.</p>
</div>
<div class="section" id="multitenancy">
<h2>Multitenancy<a class="headerlink" href="#multitenancy" title="Permalink to this headline">¶</a></h2>
<p>The HTTP API service is <strong>not</strong> intended for multi-tenant use, and most likely
never will be.</p>
<p>This means that its currently assumed that anyone allowed to connect to the
server (TLS client authentication protects anyone you haven’t given a <code class="docutils literal notranslate"><span class="pre">.key</span></code>
and <code class="docutils literal notranslate"><span class="pre">.pem</span></code> file to from connecting. So two people could access it at the same
time, but they won’t be stopped from clobbering each other’s work.</p>
</div>
<div class="section" id="file-network-etc-access">
<h2>File, Network, Etc. Access<a class="headerlink" href="#file-network-etc-access" title="Permalink to this headline">¶</a></h2>
<p>Since this just exposes existing DFFML APIs, its damn near impossible for use to
lock everything down within all the plugins of DFFML you might choose to expose
via this HTTP API. So we’re not going to try. What this means is that if you’re
running this you should sandbox it appropriately.</p>
<p>For example, if you expose the DFFML CSV source using this API, it takes a
filename parameter, which is the file containing the CSV data. Now if you say
that filename is at <code class="docutils literal notranslate"><span class="pre">/root/some/file.csv</span></code> and you’re running this as root
then it’s going to have access to that file therefore, <strong>DO NOT RUN THIS AS
ROOT</strong>, as anyone who is able to connect will have read write access to all
files on your system, you do not want to take this chance!</p>
<p>Similarly, if you expose the DFFML MySQL source, when you initialize new
MySQL protocol connections they will be originating from whatever machine is
running the HTTP API. So that means it might have access to internal databases
or something listing only on <code class="docutils literal notranslate"><span class="pre">127.0.0.1</span></code>.</p>
</div>
<div class="section" id="authentication">
<h2>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h2>
<p>TLS client authentication is currently used. There are scripts to generate basic
functioning certs. These certs should <strong>not</strong> be used in a production capacity.</p>
<p>In the future, we’ll probably support JSON Web Tokens (JWT) signed with a public
key. And then you’ll be able to provision your certs in a more reasonable way
(cert-manager if Kubernetes or something else). But for now this is what we’ve
got.</p>
<p>First, generate the server key and cert. The cert generated is only valid for
<code class="docutils literal notranslate"><span class="pre">127.0.0.1</span></code>. This will produce the server’s private key file, <code class="docutils literal notranslate"><span class="pre">server.key</span></code>,
and the server’s certificate, <code class="docutils literal notranslate"><span class="pre">server.pem</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>dffml service http createtls server
<span class="go">Generating a RSA private key</span>
<span class="go">......................................++++</span>
<span class="go">.................................++++</span>
<span class="go">writing new private key to &#39;server.key&#39;</span>
<span class="go">-----</span>
</pre></div>
</div>
<p>Then, generate the client key and cert. It will be signed by the server cert to
make it acceptable to the server. This will produce the client’s private key
file, <code class="docutils literal notranslate"><span class="pre">client.key</span></code>, the client’s certificate, <code class="docutils literal notranslate"><span class="pre">client.pem</span></code>, and the client’s
certificate signing request <code class="docutils literal notranslate"><span class="pre">client.csr</span></code> (which is unnecessary after the
command is run because it’s already been used to create <code class="docutils literal notranslate"><span class="pre">client.pem</span></code>).</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>dffml service http createtls client
<span class="go">Generating a RSA private key</span>
<span class="go">.................................................++++</span>
<span class="go">........++++</span>
<span class="go">writing new private key to &#39;client.key&#39;</span>
<span class="go">-----</span>
<span class="go">Signature ok</span>
<span class="go">subject=CN = RealUser</span>
<span class="go">Getting CA Private Key</span>
</pre></div>
</div>
<p>Now you can run the server without the <code class="docutils literal notranslate"><span class="pre">-insecure</span></code> flag.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>dffml service http server -port <span class="m">5000</span>
<span class="gp">$ </span>curl -w <span class="s1">&#39;\n&#39;</span> <span class="se">\</span>
<span class="go">    --cacert server.pem \</span>
<span class="go">    --cert client.pem \</span>
<span class="go">    --key client.key \</span>
<span class="go">    https://127.0.0.1:5000/list/sources</span>
<span class="go">... JSON output ...</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="javascript.html" class="btn btn-neutral float-right" title="JavaScript" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="api.html" class="btn btn-neutral float-left" title="API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017 - 2021, Intel.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>