

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>FLOWER17 Species classification using OpenCV and Scikit-Learn &mdash; DFFML 11d6c259 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="FLOWER17 Species classification using Transfer Learning" href="flower17_pytorch.html" />
    <link rel="prev" title="Flower17 Species Classification" href="flower17.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> DFFML
          

          
          </a>

          
            
            
              <div class="version">
                11d6c259
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/index.html">Concepts</a></li>
</ul>
<p class="caption"><span class="caption-text">Usage</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/model.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../notebooks/index.html">Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration.html">Automating Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shouldi.html">Meta Static Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dataflows.html">DataFlow HTTP Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mnist.html">MNIST Handwriten Digits</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="flower17.html">Flower17 Species Classification</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Using OpenCV to extract features and then training on a Scikit-Learn model</a></li>
<li class="toctree-l3"><a class="reference internal" href="flower17_pytorch.html">The Transfer Learning approach with Convolution Neural Networks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../or_covid_data_by_county.html">COVID Forecasting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webhook/index.html">Continuous Deployment of DataFlows</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../plugins/index.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cli.html">Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins/service/http/index.html">HTTP API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/base.html">Base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/log.html">Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/version.html">Version</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/noasync.html">Noasync</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/record.html">Record</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/high_level.html">High_Level</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/model/index.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/service/index.html">Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/configloader/index.html">Configloader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/db/index.html">Db</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/port/index.html">Port</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/operation/index.html">Operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/source/index.html">Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/feature/index.html">Feature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/cli/index.html">Cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/df/index.html">Df</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/secret/index.html">Secret</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/util/index.html">Util</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../arch/index.html">Architecture</a></li>
</ul>
<p class="caption"><span class="caption-text">Subprojects</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../shouldi.html">shouldi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../swportal.html">Software Portal</a></li>
</ul>
<p class="caption"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/intel/dffml">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://intel.github.io/dffml/master/">Master Branch Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact Us</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../news/index.html">News</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">DFFML</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Examples</a> &raquo;</li>
        
          <li><a href="flower17.html">Flower17 Species Classification</a> &raquo;</li>
        
      <li>FLOWER17 Species classification using OpenCV and Scikit-Learn</li>
    
    


      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/intel/dffml/blob/master/docs/examples/flower17/flower17_scikit.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    


  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="flower17-species-classification-using-opencv-and-scikit-learn">
<h1>FLOWER17 Species classification using OpenCV and Scikit-Learn<a class="headerlink" href="#flower17-species-classification-using-opencv-and-scikit-learn" title="Permalink to this headline">¶</a></h1>
<p>The model we’ll be using is the <cite>RandomForestClassifier</cite> which is a part of
<code class="docutils literal notranslate"><span class="pre">dffml-model-scikit</span></code>, a DFFML plugin which allows you to use Scikit-Learn via DFFML.
We’ll also be using the various operations from <code class="docutils literal notranslate"><span class="pre">dffml-operations-image</span></code>, which is
a DFFML plugin which allows you to do image processing via DFFML and
<code class="docutils literal notranslate"><span class="pre">dffml-config-yaml</span></code> and <code class="docutils literal notranslate"><span class="pre">dffml-config-image</span></code> for loading yaml and image files.
We can install them with <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pip install -U dffml-model-scikit dffml-operations-image dffml-config-yaml dffml-config-image
</pre></div>
</div>
<p>Create a dataflow config file which will be used by the
<a class="reference internal" href="../../api/source/df.html#dffml.source.df.DataFlowSource" title="dffml.source.df.DataFlowSource"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFlowSource</span></code></a> to preprocess
the data before feeding it to the model.</p>
<p>Our dataflow extracts features from the data which will then be used by the machine learning
model. Since the dataset contains flowers, we extract features that quantify the color, shape
and texture of each flower image.</p>
<p>We use the following set of operations from the <a class="reference internal" href="../../plugins/dffml_operation.html#plugin-operation-dffml-operations-image"><span class="std std-ref">dffml_operations_image</span></a>
plugin which use functions provided by OpenCV library, which the dataflow will run through to
extract features.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>resize</strong></p></td>
<td><p>This operation resizes the images up or down to the specified size.</p></td>
</tr>
<tr class="row-even"><td><p><strong>convert_color</strong></p></td>
<td><p>This operation uses the OpenCV function <cite>cv2.cvtColor</cite> and converts the image from one colorspace to another.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>calcHist</strong></p></td>
<td><p>This operation extracts the histogram from the image array and is used in this tutorial to quantify the colors present in a flower image.</p></td>
</tr>
<tr class="row-even"><td><p><strong>normalize</strong></p></td>
<td><p>This operation will be used to normalize the value range of the histogram here.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>HuMoments</strong></p></td>
<td><p>This operation calculates the seven Hu invariants which quantifies the information regarding the orientation of the image. <a class="reference external" href="https://en.wikipedia.org/wiki/Image_moment">Image Moments</a></p></td>
</tr>
<tr class="row-even"><td><p><strong>Haralick</strong></p></td>
<td><p>This operation extracts the texture features from the image.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>flatten</strong></p></td>
<td><p>This operation returns a copy of numpy array collapsed into 1 dimension.</p></td>
</tr>
</tbody>
</table>
<p>The dataflow visualised:</p>
<img alt="../../_images/dataflow_diagram1.svg" src="../../_images/dataflow_diagram1.svg" /><p>We then create the dataflow config file, using the <code class="docutils literal notranslate"><span class="pre">dataflow</span> <span class="pre">create</span></code> command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dffml</span> <span class="n">dataflow</span> \
    <span class="n">create</span> \
        <span class="n">resize</span> \
        <span class="n">calcHist</span> \
        <span class="n">Haralick</span> \
        <span class="n">HuMoments</span> \
        <span class="n">gray</span><span class="o">=</span><span class="n">convert_color</span> \
        <span class="n">hsv</span><span class="o">=</span><span class="n">convert_color</span> \
        <span class="n">flatten</span> \
        <span class="n">normalize</span> \
        <span class="n">get_single</span> \
    <span class="o">-</span><span class="n">configloader</span> <span class="n">yaml</span> \
    <span class="o">-</span><span class="n">inputs</span> \
        <span class="s1">&#39;[500,500,3]&#39;</span><span class="o">=</span><span class="n">resize</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">dsize</span> \
        <span class="s1">&#39;[0,1,2]&#39;</span><span class="o">=</span><span class="n">calcHist</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">channels</span> \
        <span class="s1">&#39;None&#39;</span><span class="o">=</span><span class="n">calcHist</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">mask</span> \
        <span class="s1">&#39;[8,8,8]&#39;</span><span class="o">=</span><span class="n">calcHist</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">histSize</span> \
        <span class="s1">&#39;[0,256,0,256,0,256]&#39;</span><span class="o">=</span><span class="n">calcHist</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ranges</span> \
        <span class="n">BGR2GRAY</span><span class="o">=</span><span class="n">convert_color</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">code</span><span class="o">=</span><span class="n">gray</span> \
        <span class="n">BGR2HSV</span><span class="o">=</span><span class="n">convert_color</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">code</span><span class="o">=</span><span class="n">hsv</span> \
        <span class="s1">&#39;[{&quot;Histogram&quot;: &quot;flatten.outputs.result&quot;},{&quot;HuMoments&quot;: &quot;HuMoments.outputs.result&quot;},{&quot;Haralick&quot;: &quot;Haralick.outputs.result&quot;}]&#39;</span><span class="o">=</span><span class="n">get_single_spec</span> \
    <span class="o">-</span><span class="n">flow</span> \
        <span class="s1">&#39;[{&quot;seed&quot;: [&quot;image&quot;]}]&#39;</span><span class="o">=</span><span class="n">resize</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">src</span> \
        <span class="s1">&#39;[{&quot;resize&quot;: &quot;result&quot;}]&#39;</span><span class="o">=</span><span class="n">hsv</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">src</span> \
        <span class="s1">&#39;[&quot;hsv&quot;]&#39;</span><span class="o">=</span><span class="n">hsv</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">code</span> \
        <span class="s1">&#39;[{&quot;hsv&quot;: &quot;result&quot;}]&#39;</span><span class="o">=</span><span class="n">calcHist</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">images</span> \
        <span class="s1">&#39;[{&quot;calcHist&quot;: &quot;result&quot;}]&#39;</span><span class="o">=</span><span class="n">normalize</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">src</span> \
        <span class="s1">&#39;[{&quot;normalize&quot;: &quot;result&quot;}]&#39;</span><span class="o">=</span><span class="n">flatten</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">array</span> \
        <span class="s1">&#39;[{&quot;resize&quot;: &quot;result&quot;}]&#39;</span><span class="o">=</span><span class="n">gray</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">src</span> \
        <span class="s1">&#39;[&quot;gray&quot;]&#39;</span><span class="o">=</span><span class="n">gray</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">code</span> \
        <span class="s1">&#39;[{&quot;gray&quot;: &quot;result&quot;}]&#39;</span><span class="o">=</span><span class="n">HuMoments</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">m</span> \
        <span class="s1">&#39;[{&quot;resize&quot;: &quot;result&quot;}]&#39;</span><span class="o">=</span><span class="n">Haralick</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">f</span> <span class="o">|</span>
    <span class="n">tee</span> <span class="n">features</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<p>To re-create the visualization of the dataflow above, run:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">dffml dataflow diagram features.yaml -simple -stages processing -configloader yaml</span>
</pre></div>
</div>
<p>Copy and pasting the output of the above code into the
<a class="reference external" href="https://mermaidjs.github.io/mermaid-live-editor">mermaidjs live editor</a>
results in the graph.</p>
<p>Train the model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>dffml train \
  -model scikitrfc \
  -model-features \
    Histogram:int:$((8*8*8)) \
    HuMoments:int:7 \
    Haralick:int:13 \
  -model-predict label:str:1 \
  -model-directory tempdir \
  -sources images=df \
    -source-images-source dir \
    -source-images-source-foldername flower_dataset/train \
    -source-images-source-labels \
      crocus windflower fritillary tulip pansy dandelion tigerlily sunflower \
      bluebell cowslip coltsfoot snowdrop daffodil lilyvalley iris buttercup daisy \
    -source-images-source-feature image \
    -source-images-dataflow features.yaml \
    -source-images-features image:int:$((500*500)) \
  -log critical
</pre></div>
</div>
<p>Assess the model’s accuracy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>dffml accuracy \
  -model scikitrfc \
  -model-features \
    Histogram:int:$((8*8*8)) \
    HuMoments:int:7 \
    Haralick:int:13 \
  -model-predict label:str:1 \
  -model-directory tempdir \
  -sources images=df \
    -source-images-source dir \
    -source-images-source-foldername flower_dataset/test \
    -source-images-source-labels \
      crocus windflower fritillary tulip pansy dandelion tigerlily sunflower \
      bluebell cowslip coltsfoot snowdrop daffodil lilyvalley iris buttercup daisy \
    -source-images-source-feature image \
    -source-images-dataflow features.yaml \
    -source-images-features image:int:$((500*500)) \
  -log critical
</pre></div>
</div>
<p>The output is:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">0.27450980392156865</span>
</pre></div>
</div>
<p>Create an <code class="docutils literal notranslate"><span class="pre">unknown_images.csv</span></code> file which contains the filenames of the images to predict on.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">&gt;</span> <span class="n">unknown_images</span><span class="o">.</span><span class="n">csv</span> <span class="o">&lt;&lt;</span> <span class="n">EOF</span>
<span class="n">key</span><span class="p">,</span><span class="n">image</span>
<span class="n">daisy</span><span class="p">,</span><span class="n">daisy</span><span class="o">.</span><span class="n">jpg</span>
<span class="n">pansy</span><span class="p">,</span><span class="n">pansy</span><span class="o">.</span><span class="n">jpg</span>
<span class="n">tigerlily</span><span class="p">,</span><span class="n">tigerlily</span><span class="o">.</span><span class="n">jpg</span>
<span class="n">buttercup</span><span class="p">,</span><span class="n">buttercup</span><span class="o">.</span><span class="n">jpg</span>
<span class="n">EOF</span>
</pre></div>
</div>
<p>In this example, the <code class="docutils literal notranslate"><span class="pre">unknown_images.csv</span></code> file contains the filenames of the following images</p>
<a class="reference internal image-reference" href="../../_images/daisy.jpg"><img alt="../../_images/daisy.jpg" src="../../_images/daisy.jpg" style="width: 140px; height: 140px;" /></a>
<a class="reference internal image-reference" href="../../_images/pansy.jpg"><img alt="../../_images/pansy.jpg" src="../../_images/pansy.jpg" style="width: 140px; height: 140px;" /></a>
<a class="reference internal image-reference" href="../../_images/tigerlily.jpg"><img alt="../../_images/tigerlily.jpg" src="../../_images/tigerlily.jpg" style="width: 140px; height: 140px;" /></a>
<a class="reference internal image-reference" href="../../_images/buttercup.jpg"><img alt="../../_images/buttercup.jpg" src="../../_images/buttercup.jpg" style="width: 140px; height: 140px;" /></a>
<p>Predict with the trained model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>dffml predict all \
  -model scikitrfc \
  -model-features \
    Histogram:int:$((8*8*8)) \
    HuMoments:int:7 \
    Haralick:int:13 \
  -model-predict label:str:1 \
  -model-directory tempdir \
  -sources images=df \
    -source-images-source csv \
    -source-images-source-filename unknown_images.csv \
    -source-images-source-loadfiles image \
    -source-images-dataflow features.yaml \
    -source-images-features image:int:$((500*500)) \
  -log critical \
  -pretty
</pre></div>
</div>
<p>Output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
    <span class="n">Key</span><span class="p">:</span>	<span class="n">daisy</span>
                                                               <span class="n">Record</span> <span class="n">Features</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>               <span class="n">image</span>               <span class="o">|</span>                     <span class="p">[[</span><span class="mi">111</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">128</span><span class="p">],</span> <span class="p">[</span><span class="mi">110</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">127</span><span class="p">],</span> <span class="p">[</span><span class="mi">109</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span>  <span class="o">...</span> <span class="p">(</span><span class="n">length</span><span class="p">:</span><span class="mi">442</span><span class="p">)</span>                      <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>             <span class="n">Histogram</span>             <span class="o">|</span>                     <span class="mf">0.45565221302156844</span><span class="p">,</span> <span class="mf">0.005917561208072317</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">...</span> <span class="p">(</span><span class="n">length</span><span class="p">:</span><span class="mi">512</span><span class="p">)</span>                      <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>             <span class="n">HuMoments</span>             <span class="o">|</span>                      <span class="mf">0.0009669592943914033</span><span class="p">,</span> <span class="mf">1.0846416009082036e-09</span><span class="p">,</span> <span class="o">...</span> <span class="p">(</span><span class="n">length</span><span class="p">:</span><span class="mi">7</span><span class="p">)</span>                       <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>              <span class="n">Haralick</span>             <span class="o">|</span>                      <span class="mf">0.0002911835961447346</span><span class="p">,</span> <span class="mf">805.9875298101111</span><span class="p">,</span> <span class="mf">0.89</span> <span class="o">...</span> <span class="p">(</span><span class="n">length</span><span class="p">:</span><span class="mi">13</span><span class="p">)</span>                      <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>

                                                                  <span class="n">Prediction</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>                                                                    <span class="n">label</span>                                                                     <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>           <span class="n">Value</span><span class="p">:</span>  <span class="n">daisy</span>           <span class="o">|</span>                                    <span class="n">Confidence</span><span class="p">:</span>   <span class="mf">0.27450980392156865</span>                                     <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>

	<span class="n">Key</span><span class="p">:</span>	<span class="n">pansy</span>
                                                               <span class="n">Record</span> <span class="n">Features</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>               <span class="n">image</span>               <span class="o">|</span>                     <span class="p">[[</span><span class="mi">153</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">136</span><span class="p">],</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">103</span><span class="p">],</span> <span class="p">[</span><span class="mi">112</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">95</span><span class="p">]</span> <span class="o">...</span> <span class="p">(</span><span class="n">length</span><span class="p">:</span><span class="mi">480</span><span class="p">)</span>                      <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>             <span class="n">Histogram</span>             <span class="o">|</span>                     <span class="mf">0.07277950023229314</span><span class="p">,</span> <span class="mf">0.0036389750116146567</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">...</span> <span class="p">(</span><span class="n">length</span><span class="p">:</span><span class="mi">512</span><span class="p">)</span>                      <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>             <span class="n">HuMoments</span>             <span class="o">|</span>                      <span class="mf">0.0012999255874069954</span><span class="p">,</span> <span class="mf">6.64033598556376e-09</span><span class="p">,</span> <span class="mi">5</span> <span class="o">...</span> <span class="p">(</span><span class="n">length</span><span class="p">:</span><span class="mi">7</span><span class="p">)</span>                       <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>              <span class="n">Haralick</span>             <span class="o">|</span>                      <span class="mf">0.00023571813835279273</span><span class="p">,</span> <span class="mf">5094.983351862911</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">...</span> <span class="p">(</span><span class="n">length</span><span class="p">:</span><span class="mi">13</span><span class="p">)</span>                      <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>

                                                                  <span class="n">Prediction</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>                                                                    <span class="n">label</span>                                                                     <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>         <span class="n">Value</span><span class="p">:</span>  <span class="n">sunflower</span>         <span class="o">|</span>                                    <span class="n">Confidence</span><span class="p">:</span>   <span class="mf">0.27450980392156865</span>                                     <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>

	<span class="n">Key</span><span class="p">:</span>	<span class="n">tigerlily</span>
                                                               <span class="n">Record</span> <span class="n">Features</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>               <span class="n">image</span>               <span class="o">|</span>                     <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span> <span class="o">...</span> <span class="p">(</span><span class="n">length</span><span class="p">:</span><span class="mi">426</span><span class="p">)</span>                      <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>             <span class="n">Histogram</span>             <span class="o">|</span>                     <span class="mf">0.2058240085942461</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">0</span> <span class="o">...</span> <span class="p">(</span><span class="n">length</span><span class="p">:</span><span class="mi">512</span><span class="p">)</span>                      <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>             <span class="n">HuMoments</span>             <span class="o">|</span>                      <span class="mf">0.0017531570284714357</span><span class="p">,</span> <span class="mf">1.2844091501399027e-08</span><span class="p">,</span> <span class="o">...</span> <span class="p">(</span><span class="n">length</span><span class="p">:</span><span class="mi">7</span><span class="p">)</span>                       <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>              <span class="n">Haralick</span>             <span class="o">|</span>                      <span class="mf">0.000361688295517474</span><span class="p">,</span> <span class="mf">2520.9790741688075</span><span class="p">,</span> <span class="mf">0.64</span> <span class="o">...</span> <span class="p">(</span><span class="n">length</span><span class="p">:</span><span class="mi">13</span><span class="p">)</span>                      <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>

                                                                  <span class="n">Prediction</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>                                                                    <span class="n">label</span>                                                                     <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>         <span class="n">Value</span><span class="p">:</span>  <span class="n">dandelion</span>         <span class="o">|</span>                                    <span class="n">Confidence</span><span class="p">:</span>   <span class="mf">0.27450980392156865</span>                                     <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>

	<span class="n">Key</span><span class="p">:</span>	<span class="n">buttercup</span>
                                                               <span class="n">Record</span> <span class="n">Features</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>               <span class="n">image</span>               <span class="o">|</span>                     <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span> <span class="o">...</span> <span class="p">(</span><span class="n">length</span><span class="p">:</span><span class="mi">424</span><span class="p">)</span>                      <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>             <span class="n">Histogram</span>             <span class="o">|</span>                     <span class="mf">0.03706228906355396</span><span class="p">,</span> <span class="mf">0.0030885240886294966</span><span class="p">,</span> <span class="mf">0.</span> <span class="o">...</span> <span class="p">(</span><span class="n">length</span><span class="p">:</span><span class="mi">512</span><span class="p">)</span>                      <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>             <span class="n">HuMoments</span>             <span class="o">|</span>                      <span class="mf">0.0013087594154773934</span><span class="p">,</span> <span class="mf">9.914047463163542e-08</span><span class="p">,</span>  <span class="o">...</span> <span class="p">(</span><span class="n">length</span><span class="p">:</span><span class="mi">7</span><span class="p">)</span>                       <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>              <span class="n">Haralick</span>             <span class="o">|</span>                      <span class="mf">0.0019601722890134747</span><span class="p">,</span> <span class="mf">6277.732845406246</span><span class="p">,</span> <span class="mf">0.51</span> <span class="o">...</span> <span class="p">(</span><span class="n">length</span><span class="p">:</span><span class="mi">13</span><span class="p">)</span>                      <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>

                                                                  <span class="n">Prediction</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>                                                                    <span class="n">label</span>                                                                     <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span>         <span class="n">Value</span><span class="p">:</span>  <span class="n">buttercup</span>         <span class="o">|</span>                                    <span class="n">Confidence</span><span class="p">:</span>   <span class="mf">0.27450980392156865</span>                                     <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
<p>The model predicts 2 of the 4 images correctly!</p>
<p>The accuracy of the model can be increased by using various preprocessing techniques
for example scaling all the feature vectors within the range [0,1].</p>
<p>Alternatively using Convolutional Neural Networks vastly improves the accuracy! -
<a class="reference external" href="flower17_pytorch.html">The Transfer Learning approach with Convolution Neural Networks</a></p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="flower17_pytorch.html" class="btn btn-neutral float-right" title="FLOWER17 Species classification using Transfer Learning" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="flower17.html" class="btn btn-neutral float-left" title="Flower17 Species Classification" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017 - 2021, Intel.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>